# Workday Weather

[Workday Weather](https://ayating.github.io/WorkdayWeather/)

Workday Weather，設計靈感來自每天上班前查看天氣的習慣。

本專案旨在打造一個專為上班族設計的小型即時互動平台，不僅提供天氣查詢功能，更融入心情抒發與社群互動元素。我們希望讓上班族在確認天氣的同時，也能透過聊天室建立人與人之間的支持網絡。如此一來，氣象資訊不再只是冰冷的數據，而是開啟對話、分享感受的起點，形成一種帶有社群溫度的氣象日常入口。

## 功能說明

<h4>互動式地圖點擊效果</h4>
  使用者可點擊台灣地圖上的任一縣市，立即取得該地區的天氣資訊。
<h4>即時天氣資訊顯示</h4>
  提供所選縣市的即時天氣狀況，資訊包含天氣概況（晴、陰、多雲、降雨）、降雨機率及相對濕度。
<h4>一週天氣預測切換</h4>
  呈現從今日起的一週天氣預報，並依據使用者點選的縣市，自動切換顯示當地的七日天氣趨勢。
<h4>下雨動畫特效</h4>
  當偵測到當地天氣為降雨時，背景自動觸發細雨動畫，營造符合當下氣候的沉浸式視覺體驗。
<h4>即時互動聊天室</h4>
  提供一個基於 SSE（Server-Sent Events） 技術的聊天室，讓使用者可以即時發送與接收訊息，分享天氣心情或相關提醒，建立社群連結。

## 技術架構與資料串接

### 前端核心技術

主要使用 HTML、 CSS、 和 Javascript 進行開發。

### 響應式網頁設計

本專案採用 RWD (響應式網頁設計) 確保在各種螢幕尺寸上皆有良好瀏覽體驗，前端主要使用 Javascript 進行開發。

### 資料串接

<h4>當日天氣資訊</h4>

- API：
  台灣未來三天天氣預報 (API: F-D0047-089)。

- 使用 Javascript fetch()方法，進行 GET 請求，取得資料。

- 即時溫度、即時濕度：

  利用條件判斷查找下一小時的資料，並用 find()方法返回。

- 即時天氣描述、即時降雨率：

  利用條件判斷，查找包含當前時間的區間資料，並用 find()方法返回。

<h4>一週天氣資訊</h4>

- API：台灣未來一週天氣預報(API: F-D0047-091)。

- 一週溫度、一週天氣描述：
  　由於目標使用者對象為上班族，我們所呈現的一週天氣資訊，選用早上六點至晚上六點區間之資料，一週天氣資訊欄位中的第一天，同步即時氣象資訊，第二天開始的欄位，使用 Javascript fetch()方法串接一週天氣 API 。

- 由於氣象局資料會根據時間做動態更新，我們使用條件判斷，固定蒐集第二天至第七天的資料，排除前後的不穩定性，並蒐集初始時間為早上六點的資料，排除夜間與凌晨的資料，作為一週天氣資料，再使用 unshift()方法插入上一支 API 的即時資料，作為第一天之資料。

<h4>聊天室資訊</h4>

- 透過 SSE（Server-Sent Events）機制與 EventSource 物件，建立與伺服器的即時通訊連線，使前端能自動接收新訊息，即時更新畫面。

### 後端核心技術

使用 Python 搭配 FastAPI 框架開發。

#### 即時聊天室系統

核心技術：SSE（Server-Sent Events）。

<h4> 訊息處理流程</h4>
 提交與驗證 (POST /api/message)： 接收前端發送的訊息，進行空值及長度（< 100 字）驗證。

<h4>暫存 (deque)</h4>
 驗證通過的訊息附加台北時區時間戳後，存入伺服器記憶體中的 deque (最多 50 則)。

<h4>讀取 (GET /api/messages)</h4>
 提供 API 供前端一次性獲取當前所有暫存訊息。

<h4>即時廣播 (SSE - GET /api/stream) </h4>
利用 SSE（Server-Sent Events），當有新訊息儲存後，主動將訊息推送給所有透過 /api/stream 連線的客戶端。FastAPI 的異步特性在此發揮良好作用。
<h4>跨日清理</h4> 內建基於台北時區的背景排程任務，每日跨日時自動清空 deque 中的訊息，並透過 SSE 發送清除指令。

### 聊天室 API 端點

- POST /api/message： 發布一則新訊息。
- GET /api/messages： 取得目前儲存的所有訊息列表。
- GET /api/stream： 建立 SSE 連線，用於接收新訊息推送及清除通知。

### 部署

- 前端靜態網頁部署於 GitHub Pages。
- 後端應用程式部署於 Render。

## 任務分工

- 丁綾葳（組長）：聊天室 API、前後端上線。

- 邵佳渝：版面配置規劃、畫面渲染。

- 蕭郁蓁：氣象資料處理、前後端串接、README 撰寫。
